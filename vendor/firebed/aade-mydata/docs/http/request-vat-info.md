# Λήψη αναφορών ΦΠΑ - RequestVatInfo

```shell
# production
https://mydatapi.aade.gr/myDATA/RequestVatInfo

# development
https://mydataapidev.aade.gr/RequestVatInfo
```

Αυτή η μέθοδος επιτρέπει στον χρήστη να λαμβάνει λεπτομερείς πληροφορίες για τα
στοιχεία ΦΠΑ που συνδέονται με τον ΑΦΜ μιας οντότητας για ένα συγκεκριμένο χρονικό
διάστημα. Η μέθοδος μπορεί να χρησιμοποιηθεί για την ανάκτηση πληροφοριών για τις
εγγραφές ΦΠΑ ενός προσώπου ή επιχείρησης.

Η επικοινωνία γίνεται μέσω μιας HTTP κλήσης GET της μεθόδου, με τις παρακάτω
παραμέτρους οι οποίες λειτουργούν ως κριτήρια αναζήτησης.

## Παράμετροι

| Όνομα Παραμέτρου | Υποχρεωτικό | Περιγραφή                                           |
|------------------|-------------|-----------------------------------------------------|
| dateFrom         | Ναι         | Ημερομηνία από dd/MM/yyyy                           |
| dateTo           | Ναι         | Ημερομηνία έως dd/MM/yyyy                           |
| entityVatNumber  | Όχι         | ΑΦΜ οντότητας                                       |
| nextPartitionKey | Όχι         | Παράμετρος για την τμηματική λήψη των αποτελεσμάτων |
| nextRowKey       | Όχι         | Παράμετρος για την τμηματική λήψη των αποτελεσμάτων |

Η απάντηση της μεθόδου θα περιλαμβάνει λεπτομέρειες ΦΠΑ, με βάση τα κριτήρια
αναζήτησης που έχουν οριστεί.

> [!TIP]
> Το αποτέλεσμα της κλήσης επιστρέφει έναν πίνακα από αντικείμενα τύπου
> [**\Firebed\AadeMyData\Models\VatInfo**](../types/vat-info-type).
> 
## Παρατηρήσεις
- Σε περίπτωση που τα αποτελέσματα αναζήτησης υπερβαίνουν το μέγιστο επιτρεπτό
  όριο, ο χρήστης θα τα λάβει τμηματικά. Τα πεδία nextPartitionKey και nextRowKey θα
  παρέχονται σε κάθε απόκριση και θα πρέπει να χρησιμοποιούνται ως παράμετροι για την
  ανάκτηση του επόμενου συνόλου αποτελεσμάτων. 
- Σε περίπτωση που η παράμετρος entityVatNumber δεν παρέχεται, θα γίνει αναζήτηση
  βάσει του ΑΦΜ του χρήστη που κάνει την κλήση. 
- Οι παράμετροι dateFrom και dateTo είναι υποχρεωτικές και πρέπει να δοθούν στη
  σωστή μορφή (dd/MM/yyyy).

## Παραδείγματα

```php
use Firebed\AadeMyData\Http\RequestVatInfo;
use Firebed\AadeMyData\Exceptions\MyDataException;

$request = new RequestVatInfo();
    
try {
    $response = $request->handle(
        dateFrom: '01/01/2021',
        dateTo: '31/12/2021'
    );
    
    // Για την κλήση του επόμενου τμήματος αποτελεσμάτων
    $continuationToken = $response->getContinuationToken();
    
    print_r($response);
} catch (MyDataException $e) {
    echo $e->getMessage();
}
```