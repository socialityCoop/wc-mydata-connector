# Τύπος Invoice

Ο τύπος `Invoice` αντιπροσωπεύει ένα αντικείμενο που περιέχει πληροφορίες
για τα παραστατικά που θα διαβιβαστούν ή έχουν διαβιβαστεί στο σύστημα του ΑΑΔΕ myDATA.

| Πεδίο                                                | Υποχρεωτικό | Περιγραφή                                                                                                 |
|------------------------------------------------------|-------------|-----------------------------------------------------------------------------------------------------------|
| uid                                                  | Όχι         | Αναγνωριστικό Παραστατικού                                                                                |
| mark                                                 | Όχι         | Καταχώρησης Παραστατικού                                                                                  |
| cancelledByMark                                      | Όχι         | Μοναδικός Αριθμός Καταχώρησης Ακυρωτικού                                                                  |
| authenticationCode                                   | Όχι         | Συμβολοσειρά Αυθεντικοποίησης                                                                             |
| transmissionFailure                                  | Όχι         | Αδυναμία Επικοινωνίας Παρόχου ή Αδυναμία Διαβίβασης Δεδομένων από ERP                                     |
| [**issuer**](party-type)                             | Όχι         | Εκδότης Παραστατικού                                                                                      |
| [**counterpart**](party-type)                        | Όχι         | Λήπτης Παραστατικού                                                                                       |
| [**paymentMethods[]**](payment-method-detail-type)   | Όχι         | Τρόποι Πληρωμής                                                                                           |
| [**invoiceHeader**](invoice-header-type)             | **Ναι**     | Επικεφαλίδα Παραστατικού                                                                                  |
| [**invoiceDetails[]**](invoice-row-type)             | **Ναι**     | Γραμμές Παραστατικού                                                                                      |
| [**taxesTotals[]**](tax-totals-type)                 | Όχι         | Σύνολα Φόρων                                                                                              |
| [**invoiceSummary**](invoice-summary-type)           | **Ναι**     | Περίληψη Παραστατικού                                                                                     |
| qrCodeUrl                                            | Όχι         | Κωδικοποιημένο αλφαριθμητικό για να χρησιμοποιηθεί από τα προγράμματα για τη δημιουργία QR Code τύπου Url |
| [**otherTransportDetails[]**](transport-detail-type) | Όχι         | Λοιπές Λεπτομέρειες Διακίνησης (Ορισμός - Αλλαγή Μτφ Μέσων)                                               |

> [!NOTE]
> Τα πεδία `uid`, `mark`, `cancelledByMark` και `authenticationCode` συμπληρώνονται από την υπηρεσία.

## Παρατηρήσεις

- Το uid αποτελεί το αναγνωριστικό κάθε παραστατικού και συμπληρώνεται από την Υπηρεσία.
  Γενικά υπολογίζεται από το SHA-1 hash των ακόλουθων πεδίων του παραστατικού τα οποία είναι :
    - ΑΦΜ Eκδότη
    - Ημερομηνία Έκδοσης
    - Αριθμός Εγκατάστασης στο Μητρώο του Taxis
    - Τύπος Παραστατικού
    - Σειρά
    - ΑΑ
    - Τύπος Απόκλισης Παραστατικού (εφόσον υπάρχει)
      Ειδικά για τα παραστατικά των κατηγοριών Β1 (Μη Αντικριζόμενα Παραστατικά
      Λήπτη ημεδαπής / αλλοδαπής) και Β2 (Αντικριζόμενα Παραστατικά Λήπτη
      ημεδαπής / αλλοδαπής) στον υπολογισμό του uid συμμετέχει και το ΑΦΜ του
      λήπτη. Κατά τη χρήση του αλγόριθμου SHA-1 χρησιμοποιείται κωδικοποίηση ISO-8859-7.
- Το `mark` αποτελεί τον Μοναδικό Αριθμό Καταχώρησης του παραστατικού (Μ.ΑΡ.Κ)
- Στο στοιχείο `taxesTotals` θα περιλαμβάνονται φόροι όλων των κατηγοριών, εκτός
  του ΦΠΑ, οι οποίοι αφορούν όλο το παραστατικό σαν σύνολο. Σε περίπτωση που ο
  χρήστης κάνει χρήση αυτού του στοιχείου, δε θα μπορεί να εισάγει φόρους εκτός
  του ΦΠΑ σε κάθε γραμμή του παραστατικού ξεχωριστά.
- Ο Μοναδικός Αριθμός Καταχώρησης Ακυρωτικού εμφανίζεται κατά τη λήψη μόνο
  εφόσον το εν λόγω παραστατικό έχει ακυρωθεί και συμπληρώνεται με το ΜΑΡΚ της
  ακύρωσης.
- Το authenticationCode αποτελεί τη συμβολοσειρά αυθεντικοποίησης κάθε
  παραστατικού και συμπληρώνεται από την Υπηρεσία για την περίπτωση που η
  αποστολή γίνεται μέσω Παρόχου Ηλεκτρονικής Τιμολόγησης. Υπολογίζεται από το
  SHA-1 hash 8 πεδίων του παραστατικού τα οποία είναι :
    - ΑΦΜ Eκδότη
    - Ημερομηνία Έκδοσης
    - Αριθμός Εγκατάστασης στο Μητρώο του Taxis
    - Τύπος Παραστατικού
    - Σειρά
    - ΑΑ
    - Μ.ΑΡ.Κ Παραστατικού
    - Συνολική Αξία Παραστατικού
    - Σύνολο Αξίας Φ.Π.Α. Παραστατικού
    - ΑΦΜ Λήπτη
- Το πεδίο qrCodeUrl περιέχει ένα url του οποίου το query string είναι
  κωδικοποιημένο, προκειμένου να χρησιμοποιηθεί από τις εφαρμογές για την
  παραγωγή/εισαγωγή στα παραστατικά QR Code τύπου url, το οποίο θα οδηγεί
  (κατά την ανάγνωση του) σε σελίδα της Υπηρεσίας για την επισκόπηση του
  παραστατικού.
- Το πεδίο otherTransportDetails (Λοιπές Λεπτομέρειες Διακίνησης) είναι λίστα
  τύπου TransportDetailType.
- Επιτρεπτές τιμές για το πεδίο `transmissionFailure` είναι:
    - **1**. Στην περίπτωση αδυναμίας επικοινωνίας οντότητας με τον πάροχο κατά την έκδοση/διαβίβαση παραστατικού (μόνο για παρόχους).
    - **2**. Στην περίπτωση αδυναμίας επικοινωνίας του παρόχου με το myDATA κατά την έκδοση/διαβίβαση παραστατικού (μόνο για παρόχους).
    - **3**. Απώλεια διασύνδεσης (είναι επιτρεπτή μόνο για περίπτωση αποστολής από ERP).
  